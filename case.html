<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Latin Noun Quiz – Tap to Match</title>
  <style>
    body { font-family: sans-serif; background: #f4f4f9; padding: 10px; }
    h2, h3 { text-align: center; }
    .menu, .quiz, .controls { text-align: center; margin: 20px auto; max-width: 600px; }
    .case-columns { display: flex; flex-wrap: wrap; justify-content: center; gap: 8px; }
    .case-box {
      border: 2px dashed #999;
      border-radius: 10px;
      padding: 8px;
      min-width: 90px;
      min-height: 50px;
      text-align: center;
      background: #fff;
    }
    .case-box.filled.correct { background-color: #c8e6c9; border-color: #4caf50; }
    .case-box.filled.incorrect { background-color: #ffcdd2; border-color: #e53935; }
    .noun-button {
      background-color: #e0f7fa;
      border: 1px solid #00796b;
      border-radius: 5px;
      padding: 6px 10px;
      margin: 4px;
      display: inline-block;
      font-size: 1rem;
      cursor: pointer;
    }
    .noun-button.selected { background-color: #b2ebf2; border-color: #004d40; }
    .word-bank { display: flex; flex-wrap: wrap; justify-content: center; gap: 5px; }
    .hidden { display: none; }
    button { margin: 5px; padding: 10px 15px; font-size: 1rem; }
  </style>
</head>
<body><h2>Latin Noun Case Match</h2><div class="menu" id="startMenu">
  <h3>Select Declensions</h3>
  <label><input type="checkbox" value="1" checked> 1st Declension</label>
  <label><input type="checkbox" value="2m" checked> 2nd Masc.</label>
  <label><input type="checkbox" value="2n" checked> 2nd Neuter</label>
  <h3>Select Cases</h3>
  <label><input type="checkbox" value="Nominative" checked> Nom</label>
  <label><input type="checkbox" value="Genitive" checked> Gen</label>
  <label><input type="checkbox" value="Dative" checked> Dat</label>
  <label><input type="checkbox" value="Accusative" checked> Acc</label>
  <label><input type="checkbox" value="Ablative" checked> Abl</label><br><br>
  <button onclick="startQuiz()">Start</button>
</div><div class="quiz hidden" id="quizSection">
  <h3 id="setTitle"></h3>
  <div class="case-columns" id="caseBoxes"></div>
  <div class="word-bank" id="wordBank"></div>
  <div class="controls">
    <button onclick="prevSet()">⬅️ Previous</button>
    <button onclick="checkAnswers()">Check</button>
    <button onclick="nextSet()">Next ➡️</button>
  </div>
</div><script>
const allSets = [
  {
    name: "puella (1st)", type: "1",
    nouns: [
      { form: "puella", case: "Nominative" },
      { form: "puellae", case: "Genitive" },
      { form: "puellae", case: "Dative" },
      { form: "puellam", case: "Accusative" },
      { form: "puella", case: "Ablative" },
      { form: "puellae", case: "Nominative" },
      { form: "puellārum", case: "Genitive" },
      { form: "puellīs", case: "Dative" },
      { form: "puellās", case: "Accusative" },
      { form: "puellīs", case: "Ablative" }
    ]
  },
  {
    name: "servus (2nd masc)", type: "2m",
    nouns: [
      { form: "servus", case: "Nominative" },
      { form: "servī", case: "Genitive" },
      { form: "servō", case: "Dative" },
      { form: "servum", case: "Accusative" },
      { form: "servō", case: "Ablative" },
      { form: "servī", case: "Nominative" },
      { form: "servōrum", case: "Genitive" },
      { form: "servīs", case: "Dative" },
      { form: "servōs", case: "Accusative" },
      { form: "servīs", case: "Ablative" }
    ]
  },
  {
    name: "templum (2nd neuter)", type: "2n",
    nouns: [
      { form: "templum", case: "Nominative" },
      { form: "templī", case: "Genitive" },
      { form: "templō", case: "Dative" },
      { form: "templum", case: "Accusative" },
      { form: "templō", case: "Ablative" },
      { form: "templa", case: "Nominative" },
      { form: "templōrum", case: "Genitive" },
      { form: "templīs", case: "Dative" },
      { form: "templa", case: "Accusative" },
      { form: "templīs", case: "Ablative" }
    ]
  }
];

let selectedSets = [], selectedCases = [], current = 0, selectedNoun = null, usedWords = new Set();

function startQuiz() {
  const types = Array.from(document.querySelectorAll('.menu input[type=checkbox]')).filter(cb => cb.checked && cb.value.length <= 3).map(cb => cb.value);
  const cases = Array.from(document.querySelectorAll('.menu input[type=checkbox]')).filter(cb => cb.checked && cb.value.length > 3).map(cb => cb.value);
  selectedSets = allSets.filter(s => types.includes(s.type));
  selectedCases = cases;
  if (!selectedSets.length || !selectedCases.length) return alert("Select at least one declension and case.");
  document.getElementById("startMenu").classList.add("hidden");
  document.getElementById("quizSection").classList.remove("hidden");
  loadSet();
}

function loadSet() {
  usedWords.clear();
  selectedNoun = null;
  const set = selectedSets[current];
  document.getElementById("setTitle").innerText = set.name;
  const filtered = set.nouns.filter(n => selectedCases.includes(n.case));

  const wordBank = document.getElementById("wordBank");
  wordBank.innerHTML = "";
  filtered.forEach((noun, i) => {
    const btn = document.createElement("div");
    btn.className = "noun-button";
    btn.innerText = noun.form;
    btn.dataset.index = i;
    btn.onclick = () => selectNoun(btn, noun);
    wordBank.appendChild(btn);
  });

  const boxes = document.getElementById("caseBoxes");
  boxes.innerHTML = "";
  selectedCases.forEach(c => {
    const box = document.createElement("div");
    box.className = "case-box";
    box.dataset.case = c;
    box.onclick = () => placeNoun(box);
    box.innerText = c;
    boxes.appendChild(box);
  });
}

function selectNoun(btn, noun) {
  if (btn.classList.contains("used")) return;
  if (selectedNoun && selectedNoun.btn === btn) {
    btn.classList.remove("selected");
    selectedNoun = null;
  } else {
    document.querySelectorAll(".noun-button").forEach(b => b.classList.remove("selected"));
    btn.classList.add("selected");
    selectedNoun = { noun, btn };
  }
}

function placeNoun(box) {
  if (!selectedNoun) return;
  if (box.classList.contains("filled")) return;

  box.innerText = selectedNoun.noun.form;
  box.dataset.form = selectedNoun.noun.form;
  box.classList.add("filled");
  selectedNoun.btn.classList.add("used");
  selectedNoun.btn.classList.remove("selected");
  selectedNoun.btn.onclick = null;
  selectedNoun = null;

  if (document.querySelectorAll('.noun-button:not(.used)').length === 0) {
    checkAnswers();
  }
}

function checkAnswers() {
  const boxes = document.querySelectorAll(".case-box");
  const set = selectedSets[current];
  const answers = set.nouns.filter(n => selectedCases.includes(n.case));
  const used = [];

  boxes.forEach(box => {
    const form = box.dataset.form;
    const c = box.dataset.case;
    const match = answers.find((n, i) => n.form === form && n.case === c && !used.includes(i));
    if (match) {
      box.classList.add("correct");
      used.push(answers.indexOf(match));
    } else {
      box.classList.add("incorrect");
    }
  });

  if (boxes.length === document.querySelectorAll(".case-box.correct").length) {
    setTimeout(() => nextSet(), 1000);
  }
}

function nextSet() {
  if (current < selectedSets.length - 1) {
    current++;
    loadSet();
  } else {
    alert("Quiz complete!");
  }
}
function prevSet() {
  if (current > 0) {
    current--;
    loadSet();
  }
}
</script></body>
</html>
