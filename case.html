<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Latin Noun Drag-and-Touch Quiz</title>
  <style>
    body { font-family: sans-serif; padding: 10px; background: #f0f0f5; }
    h2, h3 { text-align: center; }
    .case-boxes {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
      margin-bottom: 20px;
    }
    .case-box {
      flex: 1 1 25%;
      max-width: 160px;
      min-height: 60px;
      background: #fff;
      border: 2px dashed #666;
      border-radius: 8px;
      text-align: center;
      padding: 5px;
      box-sizing: border-box;
    }
    .case-box h4 {
      margin: 4px 0;
      font-size: 1em;
    }
    .word-bank {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 6px;
    }
    .noun-btn {
      padding: 6px 10px;
      font-size: 0.9rem;
      background-color: #e0f7fa;
      border: 1px solid #00796b;
      border-radius: 4px;
      cursor: pointer;
    }
    .correct { background-color: #c8e6c9 !important; }
    .incorrect { background-color: #ffcdd2 !important; }
    .selected { outline: 3px solid orange; }
    #controls, #setName { text-align: center; margin: 10px; }
    button { margin: 4px; padding: 8px 12px; font-size: 1rem; }
    #startMenu { text-align: center; margin-bottom: 20px; }
  </style>
</head>
<body><h2>Latin Noun Quiz – Touch to Match</h2><div id="startMenu">
  <h3>Select Cases:</h3>
  <label><input type="checkbox" class="case-filter" value="Nominative" checked> Nominative</label>
  <label><input type="checkbox" class="case-filter" value="Genitive" checked> Genitive</label>
  <label><input type="checkbox" class="case-filter" value="DatAbl" checked> Dative/Ablative</label>
  <label><input type="checkbox" class="case-filter" value="Accusative" checked> Accusative</label>
  <br><br>
  <button onclick="startQuiz()">Start</button>
</div><div id="setName"></div>
<div id="caseBoxes" class="case-boxes"></div>
<h3>Word Bank</h3>
<div id="wordBank" class="word-bank"></div><div id="controls">
  <button onclick="checkAnswers()">Check Answers</button>
  <button onclick="resetSet()">Reset</button>
  <button onclick="prevSet()">Previous</button>
  <button onclick="nextSet()">Next</button>
</div><script>
const allSets = [
  {
    name: "Set 1 – terra (1st declension, f)",
    words: [
      { form: "terra", case: "Nominative" },
      { form: "terrae", case: "Genitive" },
      { form: "terrae", case: "DatAbl" },
      { form: "terram", case: "Accusative" },
      { form: "terrā", case: "DatAbl" },
      { form: "terrae", case: "Nominative" },
      { form: "terrārum", case: "Genitive" },
      { form: "terrīs", case: "DatAbl" },
      { form: "terrās", case: "Accusative" },
      { form: "terrīs", case: "DatAbl" }
    ]
  },
  {
    name: "Set 2 – oppidum (2nd declension, n)",
    words: [
      { form: "oppidum", case: "Nominative" },
      { form: "oppidī", case: "Genitive" },
      { form: "oppidō", case: "DatAbl" },
      { form: "oppidum", case: "Accusative" },
      { form: "oppidō", case: "DatAbl" },
      { form: "oppida", case: "Nominative" },
      { form: "oppidōrum", case: "Genitive" },
      { form: "oppidīs", case: "DatAbl" },
      { form: "oppida", case: "Accusative" },
      { form: "oppidīs", case: "DatAbl" }
    ]
  }
];

let currentSet = 0;
let selectedCases = [];
let selectedNoun = null;
let state = {};

function startQuiz() {
  selectedCases = Array.from(document.querySelectorAll('.case-filter:checked')).map(cb => cb.value);
  document.getElementById("startMenu").style.display = "none";
  renderSet();
}

function renderSet() {
  document.getElementById("setName").innerText = allSets[currentSet].name;
  state = {};
  selectedNoun = null;
  renderCases();
  renderWordBank();
}

function renderCases() {
  const boxContainer = document.getElementById("caseBoxes");
  boxContainer.innerHTML = "";
  selectedCases.forEach(c => {
    const box = document.createElement("div");
    box.className = "case-box";
    box.dataset.case = c;
    box.innerHTML = `<h4>${c}</h4>`;
    box.onclick = () => placeNoun(box);
    boxContainer.appendChild(box);
  });
}

function renderWordBank() {
  const wordBank = document.getElementById("wordBank");
  wordBank.innerHTML = "";
  const currentWords = allSets[currentSet].words.filter(w => selectedCases.includes(w.case));
  currentWords.forEach((word, i) => {
    const id = `w${i}-${Math.random().toString(36).substr(2,5)}`;
    const btn = document.createElement("div");
    btn.className = "noun-btn";
    btn.innerText = word.form;
    btn.dataset.case = word.case;
    btn.dataset.word = word.form;
    btn.dataset.id = id;
    btn.onclick = () => selectNoun(btn);
    wordBank.appendChild(btn);
  });
}

function selectNoun(btn) {
  if (selectedNoun === btn) {
    btn.classList.remove("selected");
    selectedNoun = null;
  } else {
    document.querySelectorAll(".noun-btn").forEach(b => b.classList.remove("selected"));
    btn.classList.add("selected");
    selectedNoun = btn;
  }
}

function placeNoun(box) {
  if (!selectedNoun) return;

  const clone = selectedNoun.cloneNode(true);
  clone.classList.remove("selected");
  clone.onclick = () => {
    clone.remove();
    document.getElementById("wordBank").appendChild(clone);
    state[clone.dataset.id] = null;
  };
  box.appendChild(clone);
  state[selectedNoun.dataset.id] = box.dataset.case;
  selectedNoun.remove();
  selectedNoun = null;
}

function checkAnswers() {
  let correct = 0;
  let total = 0;
  document.querySelectorAll(".noun-btn").forEach(btn => btn.classList.remove("correct", "incorrect"));

  document.querySelectorAll(".case-box").forEach(box => {
    const expected = box.dataset.case;
    box.querySelectorAll(".noun-btn").forEach(btn => {
      total++;
      if (btn.dataset.case === expected || (expected === 'DatAbl' && (btn.dataset.case === 'Dative' || btn.dataset.case === 'Ablative'))) {
        btn.classList.add("correct");
        correct++;
      } else {
        btn.classList.add("incorrect");
      }
    });
  });

  if (correct === total && total > 0) {
    setTimeout(() => nextSet(), 1000);
  }
}

function resetSet() {
  renderSet();
}

function nextSet() {
  if (currentSet < allSets.length - 1) {
    currentSet++;
    renderSet();
  } else {
    alert("No more sets.");
  }
}

function prevSet() {
  if (currentSet > 0) {
    currentSet--;
    renderSet();
  }
}
</script></body>
</html>
