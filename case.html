<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Latin Noun Quiz</title>
  <style>
    body { font-family: sans-serif; background: #f9f9f9; padding: 10px; }
    h2, h3 { text-align: center; }
    #menu, #quiz, #result { max-width: 600px; margin: auto; }
    .case-boxes { display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; margin-top: 20px; }
    .case-box {
      width: 100px;
      height: 80px;
      border: 2px dashed #666;
      border-radius: 8px;
      text-align: center;
      padding: 4px;
      font-size: 0.9rem;
      position: relative;
      background: #fff;
    }
    .case-box span {
      display: block;
      margin-top: 6px;
      font-size: 0.8rem;
    }
    .noun-button {
      padding: 5px 10px;
      margin: 4px;
      background: #e0f7fa;
      border: 1px solid #00796b;
      border-radius: 4px;
      font-size: 0.9rem;
      cursor: pointer;
    }
    .correct { background-color: #a5d6a7 !important; }
    .incorrect { background-color: #ef9a9a !important; }
    .controls { text-align: center; margin-top: 20px; }
    button { padding: 6px 12px; margin: 4px; }
  </style>
</head>
<body><div id="menu">
  <h2>Latin Noun Quiz</h2>
  <h3>Select Cases:</h3>
  <label><input type="checkbox" value="Nominative" checked> Nominative</label>
  <label><input type="checkbox" value="Genitive" checked> Genitive</label>
  <label><input type="checkbox" value="Dative" checked> Dative</label>
  <label><input type="checkbox" value="Accusative" checked> Accusative</label>
  <label><input type="checkbox" value="Ablative" checked> Ablative</label>
  <br><br>
  <button onclick="startQuiz()">Start Quiz</button>
</div><div id="quiz" style="display:none">
  <h3 id="nounSetTitle"></h3>
  <div class="case-boxes" id="caseBoxes"></div>
  <div id="wordBank" style="text-align:center; margin-top:10px;"></div>
  <div class="controls">
    <button onclick="previousSet()">Back</button>
    <button onclick="checkAnswers()">Check Answers</button>
    <button onclick="resetSet()">Reset</button>
    <button onclick="nextSet()">Next</button>
  </div>
</div><script>
const nounSets = [
  {
    title: "puella (f., 1st declension)",
    nouns: [
      { form: "puella", case: "Nominative" },
      { form: "puellae", case: "Genitive" },
      { form: "puellae", case: "Dative" },
      { form: "puellam", case: "Accusative" },
      { form: "puella", case: "Ablative" },
      { form: "puellae", case: "Nominative" },
      { form: "puellārum", case: "Genitive" },
      { form: "puellīs", case: "Dative" },
      { form: "puellās", case: "Accusative" },
      { form: "puellīs", case: "Ablative" }
    ]
  },
  {
    title: "vir (m., 2nd declension)",
    nouns: [
      { form: "vir", case: "Nominative" },
      { form: "virī", case: "Genitive" },
      { form: "virō", case: "Dative" },
      { form: "virum", case: "Accusative" },
      { form: "virō", case: "Ablative" },
      { form: "virī", case: "Nominative" },
      { form: "virōrum", case: "Genitive" },
      { form: "virīs", case: "Dative" },
      { form: "virōs", case: "Accusative" },
      { form: "virīs", case: "Ablative" }
    ]
  }
];

let currentSetIndex = 0;
let selectedCases = [];
let answerMap = {}; // uniqueID -> correct case
let placedMap = {}; // uniqueID -> user-selected case
let idCounter = 0;

function startQuiz() {
  selectedCases = Array.from(document.querySelectorAll('#menu input[type=checkbox]:checked')).map(cb => cb.value);
  if (selectedCases.length === 0) {
    alert("Select at least one case.");
    return;
  }
  document.getElementById("menu").style.display = "none";
  document.getElementById("quiz").style.display = "block";
  renderSet();
}

function renderSet() {
  answerMap = {}; placedMap = {}; idCounter = 0;
  const set = nounSets[currentSetIndex];
  document.getElementById("nounSetTitle").innerText = set.title;
  const boxes = document.getElementById("caseBoxes");
  boxes.innerHTML = "";
  selectedCases.forEach(cs => {
    const box = document.createElement("div");
    box.className = "case-box";
    box.dataset.case = cs;
    box.innerHTML = `<strong>${cs}</strong><span></span>`;
    box.onclick = () => selectBox(box);
    boxes.appendChild(box);
  });
  const wordBank = document.getElementById("wordBank");
  wordBank.innerHTML = "";
  set.nouns.filter(n => selectedCases.includes(n.case)).forEach(noun => {
    const id = `noun-${idCounter++}`;
    answerMap[id] = noun.case;
    const btn = document.createElement("button");
    btn.className = "noun-button";
    btn.textContent = noun.form;
    btn.dataset.id = id;
    btn.onclick = () => selectNoun(btn);
    wordBank.appendChild(btn);
  });
}

let selectedNoun = null;
function selectNoun(btn) {
  if (btn.classList.contains("selected")) {
    btn.classList.remove("selected");
    selectedNoun = null;
  } else {
    document.querySelectorAll(".noun-button").forEach(b => b.classList.remove("selected"));
    btn.classList.add("selected");
    selectedNoun = btn;
  }
}

function selectBox(box) {
  if (!selectedNoun) return;
  const id = selectedNoun.dataset.id;
  const span = box.querySelector("span");
  const clone = selectedNoun.cloneNode(true);
  clone.onclick = null;
  span.appendChild(clone);
  selectedNoun.remove();
  placedMap[id] = box.dataset.case;
  selectedNoun = null;
  if (Object.keys(placedMap).length === Object.keys(answerMap).length) {
    checkAnswers();
  }
}

function checkAnswers() {
  for (const box of document.querySelectorAll(".case-box")) {
    const span = box.querySelector("span");
    span.querySelectorAll("button").forEach(btn => {
      const id = btn.dataset.id;
      if (answerMap[id] === box.dataset.case) {
        btn.classList.add("correct");
      } else {
        btn.classList.add("incorrect");
      }
    });
  }
  if (Object.keys(answerMap).every(id => placedMap[id] === answerMap[id])) {
    setTimeout(() => nextSet(), 1000);
  }
}

function resetSet() {
  renderSet();
}

function nextSet() {
  if (currentSetIndex < nounSets.length - 1) {
    currentSetIndex++;
    renderSet();
  } else {
    alert("No more sets.");
  }
}
function previousSet() {
  if (currentSetIndex > 0) {
    currentSetIndex--;
    renderSet();
  }
}
</script></body>
</html>
