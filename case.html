<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Latin Noun Quiz</title>
  <style>
    body { font-family: sans-serif; padding: 10px; background: #eef; }
    .hidden { display: none; }
    .menu, .quiz { max-width: 800px; margin: auto; }
    .case-row { display: flex; flex-wrap: wrap; justify-content: space-between; margin: 10px 0; }
    .case-box {
      flex: 1 1 30%;
      min-height: 60px;
      border: 2px dashed #999;
      margin: 5px;
      border-radius: 8px;
      padding: 5px;
      background: #fff;
    }
    .case-box h4 { margin: 2px 0; font-size: 1em; text-align: center; }
    .word-bank, .nouns-placed { display: flex; flex-wrap: wrap; justify-content: center; }
    .noun {
      background: #cce5ff;
      border: 1px solid #004085;
      border-radius: 4px;
      margin: 4px;
      padding: 6px 12px;
      font-size: 1rem;
      cursor: pointer;
      user-select: none;
    }
    .correct { background-color: #c8e6c9 !important; }
    .incorrect { background-color: #ffcdd2 !important; }
    .controls { text-align: center; margin-top: 10px; }
    button { margin: 5px; padding: 10px; font-size: 1rem; }
  </style>
</head>
<body><div class="menu">
  <h2>Latin Noun Quiz</h2>
  <p>Select declensions and cases:</p>
  <div>
    <label><input type="checkbox" value="1st" checked> 1st Declension</label>
    <label><input type="checkbox" value="2nd" checked> 2nd Declension</label>
    <label><input type="checkbox" value="3rd" checked> 3rd Declension</label>
  </div>
  <div>
    <label><input type="checkbox" value="Nominative" checked> Nominative</label>
    <label><input type="checkbox" value="Genitive" checked> Genitive</label>
    <label><input type="checkbox" value="Dative" checked> Dative</label>
    <label><input type="checkbox" value="Accusative" checked> Accusative</label>
    <label><input type="checkbox" value="Ablative" checked> Ablative</label>
  </div>
  <button onclick="startQuiz()">Start</button>
</div><div class="quiz hidden">
  <h3 id="setTitle"></h3>
  <div class="word-bank" id="wordBank"></div>
  <div id="caseBoxes" class="case-row"></div>
  <div class="controls">
    <button onclick="previousSet()">Previous</button>
    <button onclick="resetSet()">Reset</button>
    <button onclick="checkAnswers()">Check</button>
    <button onclick="nextSet()">Next</button>
  </div>
</div><script>
const allSets = [
  {
    title: "1st Declension – terra (f)", declension: "1st", gender: "f",
    forms: [
      { form: "terra", case: "Nominative" },
      { form: "terrae", case: "Genitive" },
      { form: "terrae", case: "Dative" },
      { form: "terram", case: "Accusative" },
      { form: "terrā", case: "Ablative" },
      { form: "terrae (pl.)", case: "Nominative" },
      { form: "terrārum", case: "Genitive" },
      { form: "terrīs", case: "Dative" },
      { form: "terrās", case: "Accusative" },
      { form: "terrīs", case: "Ablative" }
    ]
  },
  {
    title: "2nd Declension – fluvius (m)", declension: "2nd", gender: "m",
    forms: [
      { form: "fluvius", case: "Nominative" },
      { form: "fluviī", case: "Genitive" },
      { form: "fluviō", case: "Dative" },
      { form: "fluvium", case: "Accusative" },
      { form: "fluviō", case: "Ablative" },
      { form: "fluviī (pl.)", case: "Nominative" },
      { form: "fluviōrum", case: "Genitive" },
      { form: "fluviīs", case: "Dative" },
      { form: "fluviōs", case: "Accusative" },
      { form: "fluviīs", case: "Ablative" }
    ]
  }
];

let selectedSets = [], selectedCases = [], currentSet = 0, placedMap = {}, nounIdCounter = 0;

function startQuiz() {
  selectedCases = Array.from(document.querySelectorAll('.menu input[type=checkbox]:checked'))
    .filter(cb => ["Nominative", "Genitive", "Dative", "Accusative", "Ablative"].includes(cb.value))
    .map(cb => cb.value);

  const selectedDecls = Array.from(document.querySelectorAll('.menu input[type=checkbox]:checked'))
    .filter(cb => ["1st", "2nd", "3rd"].includes(cb.value))
    .map(cb => cb.value);

  selectedSets = allSets.filter(set => selectedDecls.includes(set.declension));
  if (!selectedSets.length || !selectedCases.length) return alert("Please select options.");

  document.querySelector(".menu").classList.add("hidden");
  document.querySelector(".quiz").classList.remove("hidden");
  renderSet();
}

function renderSet() {
  nounIdCounter = 0;
  placedMap = {};
  const set = selectedSets[currentSet];
  document.getElementById("setTitle").innerText = `${set.title}`;

  const wordBank = document.getElementById("wordBank");
  wordBank.innerHTML = "";

  const caseBoxes = document.getElementById("caseBoxes");
  caseBoxes.innerHTML = "";

  const filtered = set.forms.filter(f => selectedCases.includes(f.case));
  filtered.forEach((item, index) => {
    const id = `noun-${nounIdCounter++}`;
    const div = document.createElement("div");
    div.className = "noun";
    div.innerText = item.form;
    div.dataset.case = item.case;
    div.dataset.id = id;
    div.onclick = () => handleSelect(div);
    wordBank.appendChild(div);
  });

  selectedCases.forEach(c => {
    const box = document.createElement("div");
    box.className = "case-box";
    box.dataset.case = c;
    box.innerHTML = `<h4>${c}</h4>`;
    box.onclick = () => handlePlace(box);
    caseBoxes.appendChild(box);
  });
}

let selectedNoun = null;

function handleSelect(el) {
  if (selectedNoun && selectedNoun === el) {
    // deselect
    selectedNoun.classList.remove("selected");
    selectedNoun = null;
  } else {
    if (selectedNoun) selectedNoun.classList.remove("selected");
    selectedNoun = el;
    selectedNoun.classList.add("selected");
  }
}

function handlePlace(box) {
  if (!selectedNoun) return;
  const clone = selectedNoun.cloneNode(true);
  clone.onclick = () => {
    document.getElementById("wordBank").appendChild(clone);
    clone.classList.remove("correct", "incorrect");
    clone.onclick = () => handleSelect(clone);
    selectedNoun.remove();
    selectedNoun = null;
  };
  clone.classList.remove("selected");
  box.appendChild(clone);
  selectedNoun.remove();
  selectedNoun = null;
}

function checkAnswers() {
  let totalPlaced = document.querySelectorAll(".case-box .noun").length;
  let expected = selectedSets[currentSet].forms.filter(f => selectedCases.includes(f.case)).length;
  if (totalPlaced !== expected) return alert("Place all nouns first.");

  let allCorrect = true;
  document.querySelectorAll(".case-box").forEach(box => {
    const expectedCase = box.dataset.case;
    box.querySelectorAll(".noun").forEach(noun => {
      const isCorrect = noun.dataset.case === expectedCase;
      noun.classList.add(isCorrect ? "correct" : "incorrect");
      if (!isCorrect) allCorrect = false;
    });
  });
  if (allCorrect) setTimeout(() => nextSet(), 1000);
}

function resetSet() {
  renderSet();
}

function nextSet() {
  if (currentSet < selectedSets.length - 1) {
    currentSet++;
    renderSet();
  } else {
    alert("Quiz complete!");
    location.reload();
  }
}
function previousSet() {
  if (currentSet > 0) {
    currentSet--;
    renderSet();
  }
}
</script></body>
</html>
